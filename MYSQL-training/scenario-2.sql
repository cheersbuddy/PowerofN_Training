create database scene2;
use scene2;
create table STUDENT (ID varchar(20) primary key,	NAME varchar(20), 	DEPARTMENT varchar(20),	CGPA float);
desc STUDENT;
INSERT INTO STUDENT(ID	,NAME	,DEPARTMENT	,CGPA) VALUES ( 'S001', 'ARUN' , 'CS' ,8  ) , 
('S002', 'GITA', 'CS',7.5  ), ('S003', 'KUMAR', 'IT', 6 ),
('S004', 'ROHIT', 'IT', 8.5 ),('S005', 'YAMUNA', 'ECE',9  ), ('S006', 'YOGESH', 'ECE',9  );
SELECT * FROM STUDENT;
CREATE TABLE COMPANY(ID VARCHAR(20),	NAME VARCHAR(20),	LOCATION VARCHAR(20),	INTERVIEW_DATE DATE);
INSERT INTO  COMPANY(ID,	NAME	,LOCATION	,INTERVIEW_DATE) VALUES ('C001',	'MICROSOFT',	'BANGALORE',	'2020-08-01'),
('C002',	'AMAZON',	'CHENNAI',	'2020-09-10'),
('C003',	'FLIPKART',	'BANGALORE'	,'2020-09-15'),
('C004',	'HONEYWELL',	'HYDERABAD',	'2020-10-30'),
('C005',	'ACCENTURE',	'CHENNAI',	'2020-11-30'),
('C006',	'WIPRO',	'NOIDA',	'2020-12-31');
SELECT * FROM STUDENT;
alter table COMPANY add primary key(ID);

CREATE TABLE PLACEMENTS		(S_ID varchar(20), FOREIGN KEY (S_ID) REFERENCES STUDENT(ID),	
C_ID VARCHAR(20),FOREIGN KEY (C_ID) REFERENCES COMPANY(ID),	PACKAGE INT);
DESC PLACEMENTS;
INSERT INTO PLACEMENTS (S_ID	,C_ID,	PACKAGE) VALUES ('S001'	,'C001',	2000000),
('S002',	'C001',	2000000),
('S003',	'C002',	1200000),
('S004',	'C004',	700000),
('S004',	'C006',	400000),
('S006',	'C004',	700000);
SELECT * FROM PLACEMENTS;	

---
#1

SELECT STUDENT.NAME AS STUDENT, COMPANY.NAME AS COMPANY,PLACEMENTS.PACKAGE  AS PACKAGE 
FROM STUDENT
INNER JOIN PLACEMENTS ON STUDENT.ID = PLACEMENTS.S_ID
INNER JOIN COMPANY ON COMPANY.ID = PLACEMENTS.C_ID WHERE PACKAGE  >=2000000;
---

ALTER TABLE STUDENT ADD PLACED VARCHAR(20);
UPDATE  STUDENT, PLACEMENTS
SET    PLACED= IF(STUDENT.ID = PLACEMENTS.S_ID , 'NO', 'YES');

#STUDENT.PLACED AS PLACED;

---
#2
SELECT STUDENT.DEPARTMENT , 
case 
when package > 0 then 'YES'
 else 'NO'
end as PLACED,
IF(COMPANY.NAME  IS NULL, '-', COMPANY.NAME) AS COMPANY_NAME,
IF(PACKAGE  IS NULL, '-', PACKAGE) AS PACKAGE,
IF(STUDENT.NAME   IS NULL, '-', STUDENT.NAME)
FROM STUDENT
LEFT JOIN PLACEMENTS ON STUDENT.ID = PLACEMENTS.S_ID
LEFT JOIN COMPANY ON COMPANY.ID = PLACEMENTS.C_ID WHERE  DEPARTMENT = 'ECE';
---
SELECT E1.EMP_ID,E1.EMP_NAME,E2.EMP_NAME
FROM EMPLOYEE E1, EMPLOYEE E2
WHERE E1.EMP_ID=E2.MANAGER_ID;
SELECT P1.NAME, P2.NAME PACKAGE                     FROM PLACEMENTS P1, PLACEMENTS P2, PLACEMENTS P3 WHERE P3.PACKAGE = 2000000;
SELECT P2.PACKAGE FROM PLACEMENTS P1, PLACEMENTS P2 WHERE P1.ID = P2.S_ID;
SELECT STUDENT.NAME, COMPANY.NAME STUDENT INNER JOIN COMPANY ON   WHERE PACKAGE = MAX();


---
#3
SELECT NAME, COUNT(PLACEMENTS.C_ID) AS NO_OF_PLACED
 FROM COMPANY 
 LEFT JOIN PLACEMENTS ON COMPANY.ID = PLACEMENTS.C_ID GROUP BY NAME;
 ---
 
 ---
 #4
 SELECT NAME, MONTHNAME(INTERVIEW_DATE) AS MON
  FROM COMPANY 
  WHERE MONTH(INTERVIEW_DATE) = '9 ';
  ---
  
  ---
  #5
  SELECT NAME, INTERVIEW_DATE    FROM COMPANY WHERE INTERVIEW_DATE <  CURDATE();
  ---
  
  ---
  #6
  SELECT NAME, COUNT(PLACEMENTS.C_ID) AS NO_OF_PLACED
 FROM COMPANY 
 LEFT JOIN PLACEMENTS ON COMPANY.ID = PLACEMENTS.C_ID GROUP BY NAME;
 
 SELECT STUDENT.NAME, COMPANY.NAME 
 FROM PLACEMENTS
 INNER JOIN COMPANY ON COMPANY.ID = PLACEMENTS.C_ID 
 INNER JOIN STUDENT ON  STUDENT.ID = PLACEMENTS.ID WHERE COUNT(PLACEMENTS.C_ID) > 1 GROUP BY NAME;
 
select STUDENT.NAME , COMPANY.NAME
from STUDENT
INNER JOIN PLACEMENTS
on STUDENT.ID = PLACEMENTS.S_ID
INNER JOIN COMPANY
ON COMPANY.ID = PLACEMENTS.C_ID
where S_ID in (select S_ID from PLACEMENTS group by S_ID,COMPANY.NAME  HAVING count(STUDENT.NAME) > 1 );
 ---
 #7
 SELECT NAME, DEPARTMENT, CGPA FROM STUDENT 
 WHERE ID NOT IN  (SELECT S_ID FROM PLACEMENTS) && CGPA >7;
 ---
 
 ---
 #8
 SELECT NAME, LOCATION FROM COMPANY WHERE LOCATION  LIKE 'B%';